;***************************
;	お気に入りパッチ
;							2014/08/05
;***************************

このパッチは、eramaouのキャラクタに売却処刑禁止フラグを立てるためのパッチです。
このパッチでは、このフラグを「お気に入り」と呼んでいます。
（イメージとしてはパズドラのお気に入りそのままです。）

このパッチは、操作ミスでうっかり手塩に掛けた勇者を削除しないようにするためのものです。

	想定している利用シーンは、
	新規に捕獲した元勇者が溜まってしまった場合に
	有望な素質持ちの新人と現役の迎撃要員、助手要員をお気に入り登録し、
	そのほかをざっくり処刑するときなどです。
	
このパッチは嫁をうっかり肉便器にした悲しみを糧に作成されました。

;***************************
;	対象バージョン
;***************************

eramaou v0.304

;***************************
;	適用方法
;***************************

同梱のERBファイルをeramaouのERBフォルダに上書きコピーしてください

;***************************
;	使用フラグ
;***************************

CFLAG:700を使用しました。
	1 : お気に入り
	0 : お気に入り解除状態（デフォルト）
	
;***************************
;	使用方法
;***************************

能力表示画面の最後の行に、名前の変更や結婚と並んで「お気に入り追加」ボタンが表示されます。
このボタンを押すとお気に入り登録がされ、奴隷リスト表示の末尾に[☆]マークが表示されます。
お気に入り登録は、ダンジョン侵攻中の勇者にも実行可能です。

お気に入りを解除する場合は、お気に入り登録済みのキャラクタを能力表示画面で選択すると
「お気に入り解除」ボタンが表示されます。

お気に入り登録中の奴隷は、キャラクタを削除する処刑メニューと、売却がキャンセルされます。
キャラクタを削除しない処刑メニュー（戦闘員化と晒し台）はお気に入り登録中もそのまま実行できます。

また、勇者自動処刑機能が有効な場合で、ダンジョン侵攻中の勇者がお気に入り登録されている場合
自動処刑をスキップします。

;***************************
;	修正内容および修正個所
;***************************

■CHARA_INFO.ERB

	●行108　奴隷一覧にお気に入り登録済みを表示するように追加
	
		;お気に入り
		IF CFLAG:COUNT:700
			PRINTFORM [☆]
		ENDIF
		
	●行165　能力表示画面の最後にお気に入り登録/解除ボタンの表示を追加
	
		SIF ARG != 0
			PRINTFORM [6] %\@CFLAG:ARG:700 ? お気に入り解除 # お気に入り登録 \@% 
	
	●行195　お気に入り登録/解除処理を追加
	
		ELSEIF RESULT == 6
			IF ARG != 0
				CFLAG:ARG:700 = !CFLAG:ARG:700
				PRINTFORMW %\@CFLAG:ARG:700 ? お気に入りに登録しました。 # お気に入りを解除しました。 \@% 
				PRINTL
				RESULT = 0
			ENDIF
		ENDIF

■EXECUTION.ERB

	●行17　奴隷一覧にお気に入り登録済みを表示するように変更

		SIF CFLAG:COUNT:700
			PRINT [☆]

	●行78　お気に入りの場合、キャラクタを削除する処刑メニューがグレーダウンするように変更

		SIF CFLAG:A:700
			SETCOLOR (GETDEFCOLOR() - 0x444444)
		PRINTL [0] 追放する
		PRINTL [1] 肉便器にする
		PRINTL [2] 陵辱処刑
		PRINTL [3] 絞首刑
		SIF CFLAG:A:700
				RESETCOLOR
		PRINTL [4] 戦闘員化
		PRINTL [5] 晒し台刑
		SIF CFLAG:A:700
			SETCOLOR (GETDEFCOLOR() - 0x444444)
		PRINTL [6] 小動物化
		PRINTL [7] 博物館に飾る
		SIF CFLAG:A:700
			RESETCOLOR
		PRINTL  
		PRINTL [100] やめる
		
	●行105　お気に入りの場合、処刑処理を中断するように変更

		SELECTCASE RESULT
			CASE 0, 1, 2, 3, 6, 7
				IF CFLAG:A:700
					PRINTFORMW %SAVESTR:A%はお気に入り登録されているため処刑できません。
					GOTO INPUT_LOOP_2
				ENDIF
		ENDSELECT


■SELL_CHARA.ERB

	●行85　奴隷一覧にお気に入り登録済みを表示するように変更
	
		SIF CFLAG:COUNT:700
			PRINT [☆]

	●行78　お気に入りの場合、売却処理を中断するように変更
			
		ELSEIF CFLAG:RESULT:700
			PRINTFORMW %SAVESTR:RESULT%はお気に入り登録されているため売却できません。
			GOTO INPUT_LOOP
		ENDIF

■SYSTEM.ERB

	●行481　お気に入りの場合、自動処刑をスキップ
	
		;自動処刑
		;調教済と思われる従順の高い勇者は死を免れる
		;事前にお気に入り登録されている場合も処刑されない
		IF CFLAG:A:506 == 1 && ABL:A:10 < 2 && CFLAG:A:700 == 0
			CALL EXECUTION_MINI
	
